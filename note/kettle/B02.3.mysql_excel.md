
#### 表输入

需求：

- 将MySQL数据库中的 user 表中的数据抽取到Excel文件中

环境准备：

一、Kettle整合MySQL数据库

1、将资料中的 MySQL jdbc 驱动包导入到 pdi-ce-8.2.0.0-342\data-integration\lib 中

2、重启 Kettle



二、MySQL建库

1、导入 `资料\kettle测试数据\用户数据源\test_t_user.sql` 到 MySQL数据库中

| 准备测试数据源                                      |
| --------------------------------------------------- |
| ![1570412048454](https://user-images.githubusercontent.com/75486726/180306174-f31964c2-ad1a-437e-b2d7-11dead66faaa.png) |





实现步骤：

1、拉动 输入/表输入 、输出/Excel输出 组件、连接两个组件

2、配置表输入

3、配置Excel输出组件



具体操作：

1、拉动 输入/表输入 、输出/Excel输出 组件、连接两个组件

2、配置表输入

2.1 新建数据库连接

| kettle新建数据库连接                       |
| ------------------------------------------ |
| ![1569633093678](https://user-images.githubusercontent.com/75486726/180306201-0cf87642-67fd-4d7d-bad9-7a9109ffea53.png) |



2.2 选择 t_user 表，并获取SQL查询语句

| 编写sql语句                                |
| ------------------------------------------ |
| ![1570331859373](https://user-images.githubusercontent.com/75486726/180306229-77b942c0-deaa-4c94-8ad3-8d546bdc95db.png) |



2.3 预览数据

| 预览数据                                   |
| ------------------------------------------ |
| ![1570331893525](https://user-images.githubusercontent.com/75486726/180306262-ba08edca-41ab-4d97-abfd-cd77231394f4.png) |

**注意：创建一个共享的数据库连接操作步骤**

| 主对象树--》DB连接                                           |
| ------------------------------------------------------------ |
| ![image-20200220143959173](https://user-images.githubusercontent.com/75486726/180306302-f1240e79-81ae-43ad-b14d-a46c04f506e5.png) |



| 新建连接                                                     |
| ------------------------------------------------------------ |
| ![image-20200220144039392](https://user-images.githubusercontent.com/75486726/180306336-4095da94-e570-49d5-9a9b-2ea299382673.png) |



| 设置连接共享                                                 |
| ------------------------------------------------------------ |
| ![image-20200220144227459](https://user-images.githubusercontent.com/75486726/180306363-a83a8ae0-963d-4ef7-a5bf-6546dac10880.png) |

鼠标右键--》共享；字体变粗后该连接可以全局使用！

3、配置Excel输出组件

* 指定Excel输出位置

| 指定excel输出位置                                   |
| --------------------------------------------------- |
| ![1570332047436](https://user-images.githubusercontent.com/75486726/180306406-51c7b5bb-b227-44e6-ac28-3c2927afce85.png) |

