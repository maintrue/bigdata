
#### 表输入

需求：

- 将MySQL数据库中的 user 表中的数据抽取到Excel文件中

环境准备：

一、Kettle整合MySQL数据库

1、将资料中的 MySQL jdbc 驱动包导入到 pdi-ce-8.2.0.0-342\data-integration\lib 中

2、重启 Kettle



二、MySQL建库

1、导入 `资料\kettle测试数据\用户数据源\test_t_user.sql` 到 MySQL数据库中

| 准备测试数据源                                      |
| --------------------------------------------------- |
| <img src="assets/1570412048454.png" align="left" /> |





实现步骤：

1、拉动 输入/表输入 、输出/Excel输出 组件、连接两个组件

2、配置表输入

3、配置Excel输出组件



具体操作：

1、拉动 输入/表输入 、输出/Excel输出 组件、连接两个组件

2、配置表输入

2.1 新建数据库连接

| kettle新建数据库连接                       |
| ------------------------------------------ |
| ![1569633093678](assets/1569633093678.png) |



2.2 选择 t_user 表，并获取SQL查询语句

| 编写sql语句                                |
| ------------------------------------------ |
| ![1570331859373](assets/1570331859373.png) |



2.3 预览数据

| 预览数据                                   |
| ------------------------------------------ |
| ![1570331893525](assets/1570331893525.png) |

**注意：创建一个共享的数据库连接操作步骤**

| 主对象树--》DB连接                                           |
| ------------------------------------------------------------ |
| ![image-20200220143959173](assets/image-20200220143959173.png) |



| 新建连接                                                     |
| ------------------------------------------------------------ |
| ![image-20200220144039392](assets/image-20200220144039392.png) |



| 设置连接共享                                                 |
| ------------------------------------------------------------ |
| ![image-20200220144227459](assets/image-20200220144227459.png) |

鼠标右键--》共享；字体变粗后该连接可以全局使用！

3、配置Excel输出组件

* 指定Excel输出位置

  | 指定excel输出位置                                   |
        | --------------------------------------------------- |
  | <img src="assets/1570332047436.png" align="left" /> |

