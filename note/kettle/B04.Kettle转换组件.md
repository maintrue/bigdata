
###  Kettle转换组件

* 转换是ETL的T，T就是Transform清洗、转换

* ETL三个部分中，T花费时间最长,是“一般情况下这部分工作量是整个ETL的2/3

| kettle转换组件                                      |
| --------------------------------------------------- |
| ![1569672821580](https://user-images.githubusercontent.com/75486726/180308894-b580e368-79c4-49c1-b137-3f76153b634d.png) |





####  值映射

* 值映射就是把字段的一个值映射成其他的值
* 在数据质量规范上使用非常多，比如很多系统对应性别gender字段的定义不同
    * 系统1：1 男、2女
    * 系统2：f 男、m 女
    * 数据仓库统一为：male 男、female女



需求：

- 从user.json 中读取数据，并把gender列
    - 0 -> 男
    - 1 -> 女
    - 2 -> 保密
- 写入到Excel文件



实现步骤：

1、拖入一个 JSON输入组件、一个值映射转换组件、一个Excel输出组件，连接三个组件

2、配置JSON输入组件

3、配置值映射转换组件

4、配置Excel输出组件



具体实现：

1、拖入一个 JSON输入组件、一个值映射转换组件、一个Excel输出组件，连接三个组件

| 组件配置图                                 |
| ------------------------------------------ |
| ![1570415691415](https://user-images.githubusercontent.com/75486726/180308928-8d11142f-385d-4c81-a67d-f501908ec245.png) |



2、配置JSON输入组件

3、配置值映射转换组件

| 值映射组件                                          |
| --------------------------------------------------- |
| ![1570415717712](https://user-images.githubusercontent.com/75486726/180308952-4f9b81b3-35fe-4b7c-8666-8a7888613348.png) |

4、配置Excel输出组件



####  增加序列

* 增加序列就是给数据流增加一个序列字段

| 增加序列                                            |
| --------------------------------------------------- |
| ![1569674394571](https://user-images.githubusercontent.com/75486726/180308975-ad5b0df4-763a-449c-9820-4825593b6bb9.png) |





需求：

* 从 user.json 读取数据，并添加序列，把数据保存到Excel

实现步骤：

1、拖入JSON输入组件、增加序列组件、Excel输出组件，并连接三个组件

| 组件配置图                                 |
| ------------------------------------------ |
| ![1570416388533](https://user-images.githubusercontent.com/75486726/180309022-bff9161b-f92e-4894-8099-e3137800c606.png) |



2、配置JSON Input组件

3、配置增加序列组件

| 配置增加序列                                        |
| --------------------------------------------------- |
| ![1570416417532](https://user-images.githubusercontent.com/75486726/180309057-4ca0c9f8-67a7-4d6d-a7ce-20119aaa8aa7.png) |



4、配置Excel输出组件



#### 字段选择

* 字段选择是从数据流中选择字段、改变名称、修改数据类型

需求：

- 从 user.json 中读取数据
- 移除birthday和register_date
- 把phone列名改为telephone，id列名改为key，gender列名改为sex
- 输出到Excel文件中



实现步骤：
1、拖入 JSON输入 组件、字段选择组件、Excel输出组件

| 组件配置图                                 |
| ------------------------------------------ |
| ![1570416693317](https://user-images.githubusercontent.com/75486726/180309084-99322f72-1ce7-460d-955d-70205520b979.png) |

2、配置输入、字段选择、输出组件

| 配置输入，字段选择，输出组件               |
| ------------------------------------------ |
| ![1570416732572](https://user-images.githubusercontent.com/75486726/180309107-d600411d-d3df-4c15-ba24-b1ea62f5f516.png) |

