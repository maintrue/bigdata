
###  Kettle转换组件

* 转换是ETL的T，T就是Transform清洗、转换

* ETL三个部分中，T花费时间最长,是“一般情况下这部分工作量是整个ETL的2/3

  | kettle转换组件                                      |
        | --------------------------------------------------- |
  | <img src="assets/1569672821580.png" align="left" /> |





####  值映射

* 值映射就是把字段的一个值映射成其他的值
* 在数据质量规范上使用非常多，比如很多系统对应性别gender字段的定义不同
    * 系统1：1 男、2女
    * 系统2：f 男、m 女
    * 数据仓库统一为：male 男、female女



需求：

- 从user.json 中读取数据，并把gender列
    - 0 -> 男
    - 1 -> 女
    - 2 -> 保密
- 写入到Excel文件



实现步骤：

1、拖入一个 JSON输入组件、一个值映射转换组件、一个Excel输出组件，连接三个组件

2、配置JSON输入组件

3、配置值映射转换组件

4、配置Excel输出组件



具体实现：

1、拖入一个 JSON输入组件、一个值映射转换组件、一个Excel输出组件，连接三个组件

| 组件配置图                                 |
| ------------------------------------------ |
| ![1570415691415](assets/1570415691415.png) |



2、配置JSON输入组件

3、配置值映射转换组件

| 值映射组件                                          |
| --------------------------------------------------- |
| <img src="assets/1570415717712.png" align="left" /> |

4、配置Excel输出组件



####  增加序列

* 增加序列就是给数据流增加一个序列字段

  | 增加序列                                            |
        | --------------------------------------------------- |
  | <img src="assets/1569674394571.png" align="left" /> |





需求：

* 从 user.json 读取数据，并添加序列，把数据保存到Excel

实现步骤：

1、拖入JSON输入组件、增加序列组件、Excel输出组件，并连接三个组件

| 组件配置图                                 |
| ------------------------------------------ |
| ![1570416388533](assets/1570416388533.png) |



2、配置JSON Input组件

3、配置增加序列组件

| 配置增加序列                                        |
| --------------------------------------------------- |
| <img src="assets/1570416417532.png" align="left" /> |



4、配置Excel输出组件



#### 字段选择

* 字段选择是从数据流中选择字段、改变名称、修改数据类型

需求：

- 从 user.json 中读取数据
- 移除birthday和register_date
- 把phone列名改为telephone，id列名改为key，gender列名改为sex
- 输出到Excel文件中



实现步骤：
1、拖入 JSON输入 组件、字段选择组件、Excel输出组件

| 组件配置图                                 |
| ------------------------------------------ |
| ![1570416693317](assets/1570416693317.png) |

2、配置输入、字段选择、输出组件

| 配置输入，字段选择，输出组件               |
| ------------------------------------------ |
| ![1570416732572](assets/1570416732572.png) |

