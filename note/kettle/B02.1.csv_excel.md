#### Kettle入门案例

需求：

* 把数据从CSV文件（ketttle测试数据\用户数据源\user.csv）抽取到Excel文件

数据源：

| id                 | name | age  | gender | province | city   | region   | phone       | birthday   | hobby              | 注册时间            |
| ------------------ | ---- | ---- | ------ | -------- | ------ | -------- | ----------- | ---------- | ------------------ | ------------------- |
| 392456197008193000 | 张三 | 20   | 0      | 北京市   | 昌平区 | 回龙观   | 18589407692 | 1970-08-19 | 美食;篮球;足球     | 2018-08-06 09:44:43 |
| 267456198006210000 | 李四 | 25   | 1      | 河南省   | 郑州市 | 郑东新区 | 18681109672 | 1980-06-21 | 音乐;阅读;旅游     | 2017-04-07 09:14:13 |
| 892456199007203000 | 王五 | 24   | 1      | 湖北省   | 武汉市 | 汉阳区   | 18798009102 | 1990-07-20 | 写代码;读代码;算法 | 2016-06-08 07:34:23 |
| 492456198712198000 | 赵六 | 26   | 2      | 陕西省   | 西安市 | 莲湖区   | 18189189195 | 1987-12-19 | 购物;旅游          | 2016-01-09 19:15:53 |
| 392456197008193000 | 张三 | 20   | 0      | 北京市   | 昌平区 | 回龙观   | 18589407692 | 1970-08-19 | 美食;篮球;足球     | 2018-08-06 09:44:43 |
| 392456197008193000 | 张三 | 20   | 0      | 北京市   | 昌平区 | 回龙观   | 18589407692 | 1970-08-19 | 美食;篮球;足球     | 2018-08-06 09:44:43 |



实现步骤：

1、在Kettle中新建转换

2、拖拽一个CSV输入组件、一个Excel输出组件、并按住Shift拖动鼠标连接两个组件

3、配置CSV输入组件、Excel输出组件



具体实现：

1、新建转换

| 新建转换                                                     |
| ------------------------------------------------------------ |
| ![image-20200109104022621](assets/image-20200109104022621.png) |



2、拖拽一个CSV输入组件、一个Excel输出组件、并按住Shift拖动鼠标连接两个组件

| 组件架构图                                 |
| ------------------------------------------ |
| ![1570240867723](assets/1570240867723.png) |



3、配置CSV输入组件

* 选择要进行导入的CSV数据源
* 点击 「获取字段」，读取CSV中的列
* 点击  「预览」，浏览CSV中的数据

![1570328488039](assets/1570328488039.png)

![1570328569580](assets/1570328569580.png)

4、配置Excel组件

| 指定输出Excel文件的位置                             |
| --------------------------------------------------- |
| <img src="assets/1570328608969.png" align="left" /> |



5、点击 三角形 箭头执行

| 执行                                                         |
| ------------------------------------------------------------ |
| <img src="assets/1570328732887.png" align="left" style="border:1px solid #999"/> |


